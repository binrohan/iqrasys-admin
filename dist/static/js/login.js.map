{"version":3,"file":"static/js/login.js","mappings":"mBAAA,IAAIA,EAAsC,WAStC,OARAA,EAAWC,OAAOC,QAAU,SAASC,GACjC,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAII,KADTL,EAAIG,UAAUF,GACOJ,OAAOS,UAAUC,eAAeC,KAAKR,EAAGK,KACzDN,EAAEM,GAAKL,EAAEK,IAEjB,OAAON,GAEJH,EAASa,MAAMC,KAAMP,YAuC5BQ,EAAiB,CACjB,8BAA+B,IAC/B,eAAgB,oBAkBTC,EAAQ,SAAUC,GAAW,OAzDcC,OAyDG,EAzDMC,OAyDE,EAzDaC,EAyDG,WAC7E,IAAIC,EAAKC,EACT,OAlD4C,SAAUJ,EAASK,GAC/D,IAAsGC,EAAGC,EAAGtB,EAAGuB,EAA3GC,EAAI,CAAEC,MAAO,EAAGC,KAAM,WAAa,GAAW,EAAP1B,EAAE,GAAQ,MAAMA,EAAE,GAAI,OAAOA,EAAE,IAAO2B,KAAM,GAAIC,IAAK,IAChG,OAAOL,EAAI,CAAEM,KAAMC,EAAK,GAAI,MAASA,EAAK,GAAI,OAAUA,EAAK,IAAwB,mBAAXC,SAA0BR,EAAEQ,OAAOC,UAAY,WAAa,OAAOrB,OAAUY,EACvJ,SAASO,EAAK3B,GAAK,OAAO,SAAU8B,GAAK,OACzC,SAAcC,GACV,GAAIb,EAAG,MAAM,IAAIc,UAAU,mCAC3B,KAAOX,OACH,GAAIH,EAAI,EAAGC,IAAMtB,EAAY,EAARkC,EAAG,GAASZ,EAAU,OAAIY,EAAG,GAAKZ,EAAS,SAAOtB,EAAIsB,EAAU,SAAMtB,EAAES,KAAKa,GAAI,GAAKA,EAAEO,SAAW7B,EAAIA,EAAES,KAAKa,EAAGY,EAAG,KAAKE,KAAM,OAAOpC,EAE3J,OADIsB,EAAI,EAAGtB,IAAGkC,EAAK,CAAS,EAARA,EAAG,GAAQlC,EAAEqC,QACzBH,EAAG,IACP,KAAK,EAAG,KAAK,EAAGlC,EAAIkC,EAAI,MACxB,KAAK,EAAc,OAAXV,EAAEC,QAAgB,CAAEY,MAAOH,EAAG,GAAIE,MAAM,GAChD,KAAK,EAAGZ,EAAEC,QAASH,EAAIY,EAAG,GAAIA,EAAK,CAAC,GAAI,SACxC,KAAK,EAAGA,EAAKV,EAAEI,IAAIU,MAAOd,EAAEG,KAAKW,MAAO,SACxC,QACI,MAAkBtC,GAAZA,EAAIwB,EAAEG,MAAYtB,OAAS,GAAKL,EAAEA,EAAEK,OAAS,KAAkB,IAAV6B,EAAG,IAAsB,IAAVA,EAAG,IAAW,CAAEV,EAAI,EAAG,SACjG,GAAc,IAAVU,EAAG,MAAclC,GAAMkC,EAAG,GAAKlC,EAAE,IAAMkC,EAAG,GAAKlC,EAAE,IAAM,CAAEwB,EAAEC,MAAQS,EAAG,GAAI,MAC9E,GAAc,IAAVA,EAAG,IAAYV,EAAEC,MAAQzB,EAAE,GAAI,CAAEwB,EAAEC,MAAQzB,EAAE,GAAIA,EAAIkC,EAAI,MAC7D,GAAIlC,GAAKwB,EAAEC,MAAQzB,EAAE,GAAI,CAAEwB,EAAEC,MAAQzB,EAAE,GAAIwB,EAAEI,IAAIW,KAAKL,GAAK,MACvDlC,EAAE,IAAIwB,EAAEI,IAAIU,MAChBd,EAAEG,KAAKW,MAAO,SAEtBJ,EAAKd,EAAKX,KAAKM,EAASS,GAC1B,MAAOgB,GAAKN,EAAK,CAAC,EAAGM,GAAIlB,EAAI,EAAK,QAAUD,EAAIrB,EAAI,EACtD,GAAY,EAARkC,EAAG,GAAQ,MAAMA,EAAG,GAAI,MAAO,CAAEG,MAAOH,EAAG,GAAKA,EAAG,QAAK,EAAQE,MAAM,GArB9BK,CAAK,CAACtC,EAAG8B,MA+ClDS,CAAY/B,MAAM,SAAUgC,GAC/B,OAAQA,EAAGlB,OACP,KAAK,EAAG,MAAO,CAAC,EAAamB,MAAM,GAAGC,OAzBnC,wBAyBoD,mBAAoB,CACnEC,OAAQ,OACRC,QAASlD,EAAS,GAAIe,GACtBQ,KAAM4B,KAAKC,UAAUnC,MAE7B,KAAK,EAED,IADAI,EAAMyB,EAAGjB,QACDwB,OAAS,KAAOhC,EAAIgC,OAAS,IACjC,MAAM,IAAIC,MAAMjC,EAAIkC,YAExB,MAAO,CAAC,EAAalC,EAAImC,QAC7B,KAAK,EAGD,OAlCUC,EAgCVnC,EAAOwB,EAAGjB,OAhCM6B,EAiCArC,EAAI6B,QAAQS,IAAI,yBAhC5CC,aAAaC,QAAQ,WAAYV,KAAKC,UAAUK,IAChDG,aAAaC,QAAQ,YAAaH,GAgCf,CAAC,EAAcpC,GAlCtB,IAAUmC,EAAMC,MAvCrB,KAFgEI,OAyDF,KAvDnDA,EAAIC,WAAU,SAAUC,EAASC,GAC/C,SAASC,EAAU1B,GAAS,IAAMI,EAAKxB,EAAUY,KAAKQ,IAAW,MAAOG,GAAKsB,EAAOtB,IACpF,SAASwB,EAAS3B,GAAS,IAAMI,EAAKxB,EAAiB,MAAEoB,IAAW,MAAOG,GAAKsB,EAAOtB,IACvF,SAASC,EAAKwB,GAJlB,IAAe5B,EAIa4B,EAAO7B,KAAOyB,EAAQI,EAAO5B,QAJ1CA,EAIyD4B,EAAO5B,MAJhDA,aAAiBsB,EAAItB,EAAQ,IAAIsB,GAAE,SAAUE,GAAWA,EAAQxB,OAIT6B,KAAKH,EAAWC,GAClGvB,GAAMxB,EAAYA,EAAUP,MAAMK,EAASC,GAAc,KAAKa,WAN1B,IAAUd,EAASC,EAAY2C,EAAG1C,GCT1EkD,EAASC,SAASC,cAAc,eAChCC,EAAWF,SAASC,cAAc,oBAClC,EAAWD,SAASC,cAAc,wBACtCF,EAAOI,iBAAiB,UAAU,SAAU/B,GACxCA,EAAEgC,iBACF,IAAI1D,EAAU,CACVwD,SAAUA,EAASjC,MACnBoC,SAAU,EAASpC,OAEvBxB,EAAMC,GAASoD,MAAK,SAAU/C,GAC1BuD,OAAOC,SAASC,QAAQ,kBACzBC,OAAM,SAAUC,GACfC,QAAQC,IAAIF,U","sources":["webpack://boilerplate/./src/services/auth-service.ts","webpack://boilerplate/./src/ts/login.ts"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nvar __generator = (this && this.__generator) || function (thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n};\r\nvar BASE_URL = \"http://localhost:5000\";\r\nvar COMMON_HEADERS = {\r\n    'Access-Control-Allow-Origin': \"*\",\r\n    \"Content-Type\": \"application/json\"\r\n};\r\nvar storeUser = function (user, token) {\r\n    localStorage.setItem('USERV1.0', JSON.stringify(user));\r\n    localStorage.setItem('TOKENV1.0', token);\r\n};\r\nexport var isLoggedIn = function () { return __awaiter(void 0, void 0, void 0, function () {\r\n    var tokenJSON, token;\r\n    return __generator(this, function (_a) {\r\n        tokenJSON = localStorage.getItem('TOKENV1.0');\r\n        if (!tokenJSON) {\r\n            localStorage.removeItem('USERV1.0');\r\n            throw new Error(\"User not authenticated\");\r\n        }\r\n        token = JSON.parse(tokenJSON);\r\n        return [2 /*return*/, tokenExpirationCheck(token)];\r\n    });\r\n}); };\r\nexport var login = function (payload) { return __awaiter(void 0, void 0, void 0, function () {\r\n    var res, data;\r\n    return __generator(this, function (_a) {\r\n        switch (_a.label) {\r\n            case 0: return [4 /*yield*/, fetch(\"\".concat(BASE_URL, \"/api/auth/login\"), {\r\n                    method: 'POST',\r\n                    headers: __assign({}, COMMON_HEADERS),\r\n                    body: JSON.stringify(payload)\r\n                })];\r\n            case 1:\r\n                res = _a.sent();\r\n                if (res.status > 299 || res.status < 200) {\r\n                    throw new Error(res.statusText);\r\n                }\r\n                return [4 /*yield*/, res.json()];\r\n            case 2:\r\n                data = _a.sent();\r\n                storeUser(data, res.headers.get('X-Authorization-Token'));\r\n                return [2 /*return*/, data];\r\n        }\r\n    });\r\n}); };\r\nvar tokenExpirationCheck = function (token) { return __awaiter(void 0, void 0, void 0, function () {\r\n    var res, data;\r\n    return __generator(this, function (_a) {\r\n        switch (_a.label) {\r\n            case 0: return [4 /*yield*/, fetch(\"\".concat(BASE_URL, \"/api/check\"), {\r\n                    method: 'POST',\r\n                    headers: __assign(__assign({}, COMMON_HEADERS), { Authorization: token })\r\n                })];\r\n            case 1:\r\n                res = _a.sent();\r\n                if (res.status === 401)\r\n                    throw new Error(\"User authentication sesson over.\");\r\n                if (res.status !== 200)\r\n                    throw new Error(res.statusText);\r\n                return [4 /*yield*/, res.json()];\r\n            case 2:\r\n                data = _a.sent();\r\n                return [2 /*return*/, data];\r\n        }\r\n    });\r\n}); };\r\n","import '../css/index.css';\r\nimport { login } from '../services/auth-service';\r\nvar formEl = document.querySelector('#login-form');\r\nvar username = document.querySelector('input[name=name]');\r\nvar password = document.querySelector('input[name=password]');\r\nformEl.addEventListener('submit', function (e) {\r\n    e.preventDefault();\r\n    var payload = {\r\n        username: username.value,\r\n        password: password.value\r\n    };\r\n    login(payload).then(function (data) {\r\n        window.location.replace('/index.html');\r\n    }).catch(function (err) {\r\n        console.log(err);\r\n    });\r\n});\r\n"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","COMMON_HEADERS","login","payload","thisArg","_arguments","generator","res","data","body","f","y","g","_","label","sent","trys","ops","next","verb","Symbol","iterator","v","op","TypeError","done","value","pop","push","e","step","__generator","_a","fetch","concat","method","headers","JSON","stringify","status","Error","statusText","json","user","token","get","localStorage","setItem","P","Promise","resolve","reject","fulfilled","rejected","result","then","formEl","document","querySelector","username","addEventListener","preventDefault","password","window","location","replace","catch","err","console","log"],"sourceRoot":""}